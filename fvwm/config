# -*- mode: conf -*-

# Virtual desktops
DesktopSize 3x3
DesktopName 0 Main
DesktopName 1 Work
DesktopName 2 Games
EdgeScroll 100 100
EdgeResistance 150 150
EdgeThickness 1

Style * GrabFocusOff

# SmartPlacement makes new windows pop-up in blank regions of screen.  If
# SmartPlacement fails, RandomPlacement places it randomly instead of making
# you do it.
Style * SmartPlacement
Style * RandomPlacement

# Mouse and focus behaviour
ClickTime 750
MoveThreshold 3
Style * SloppyFocus, MouseFocusClickRaises

OpaqueMoveSize -1
Emulate MWM
HideGeometryWindow Always
SnapAttraction 5 SameType Screen
SnapGrid 3 3
XorValue 55555
Style * DecorateTransient, DontRaiseTransient
Style * DontLowerTransient, StackTransientParent
Style * GrabFocusTransientOff
Style * WindowShadeSteps 20, WindowShadeScrolls
SetAnimation 10 -.01 0 .01 .03 .08 .18 .3 .45 .6 .75 .85 .90 .94 .97 .99 1.0
Style * MwmDecor, SlipperyIcon
Style * IconBox 0 -10 -280 -1

Style *     BorderWidth 4
Style *     HandleWidth 4
#Style *     FvwmBorder # turn off 3d bevel
#Style *     FirmBorder # border is not depressable
Style *     SnapAttraction 20

Style *     IconFont -adobe-times-bold-r-*-*-12-*-*-*-*-*-*-*
MenuStyle * Font -adobe-times-bold-r-*-*-12-*-*-*-*-*-*-*
MenuStyle * fvwm, Foreground black, Background gainsboro, Greyed grey40

# Style specific to programs 
Style "xload" 		NoTitle, Sticky, WindowListSkip, ClickToFocus
Style "xconsole"	NoTitle, Sticky, WindowListSkip, ClickToFocus
Style "Fvwm*"		NoTitle, Sticky, WindowListSkip

DestroyFunc InitFunction
AddToFunc InitFunction
  + I Exec xset -b
  + I Exec xrdb .Xresources
  + I Exec xsetroot -solid "#777777"
  + I Exec xmodmap ~/.Xmodmap
  + I Module FvwmAnimate
  + I Exec xinput set-int-prop "TPPS/2 IBM TrackPoint" "Evdev Wheel Emulation" 8 1
  + I Exec xinput set-int-prop "TPPS/2 IBM TrackPoint" "Evdev Wheel Emulation Button" 8 2
  + I Exec xinput set-int-prop "TPPS/2 IBM TrackPoint" "Evdev Wheel Emulation Axes" 8 6 7 4 5
  + I Exec xload xload -geometry 136x136-0-0

DestroyFunc StartFunction
AddToFunc StartFunction
  + I Exec compton -cC -r 16 -o 0.4 -l -25 -t -10 -f -D 1 -e 0.5 -b

DestroyFunc SelectWindow
AddToFunc SelectWindow
  + I Focus
  + I Iconify false
  + I Raise
  + I WarpToWindow 50 17p

AddToFunc Rxvt
  + I Exec exec rxvt
  + I Wait rxvt
  + I Next (rxvt) WarpToWindow 50 17p

AddToFunc EmacsClient
  + I Exec exec emacsclient -nc
  + I Wait emacs
  + I Next (emacs) WarpToWindow 50 17p

# Window switcher
InfoStoreAdd DIR Next

DestroyFunc FuncSwitchWindow
AddToFunc FuncSwitchWindow
  + I $[infostore.DIR] (CurrentDesk, !Iconic, !Sticky) SelectWindow
  + I Deschedule 134000
  + I PipeRead `[ "$[infostore.DIR]" == "Prev" ] && \
                echo 'InfoStoreAdd NDIR Next' || \
                echo 'InfoStoreAdd NDIR Prev'`
  + I Schedule 700 134000 InfoStoreAdd DIR $[infostore.NDIR]

DestroyFunc CloseWindow
AddToFunc CloseWindow
  + I Close
  + I Previous WarpToWindow 50 17p

AddToFunc SwitchWindow
  + I $[DIR] (CurrentPage, !Iconic, !Sticky) FocusRaiseAndStuff
  + I Deschedule 134000
  + I PipeRead `[ "$[DIR]" == "Prev" ] &amp;&amp; \
      echo 'SetEnv NDIR Next' || \
      echo 'SetEnv NDIR Prev'`
  + I Schedule 700 134000 SetEnv DIR $[NDIR]

DestroyFunc Thumbnail
AddToFunc Thumbnail
  + I Raise
  + I ThisWindow (!Shaded, Iconifiable, !Iconic) PipeRead \
      "xwd -silent -id $[w.id] | convert -scale 128 -frame 1x1 \
      -mattecolor black -quality 0 xwd:- \
      png:$[FVWM_USERDIR]/icon.tmp.$[w.id].png && \
      echo WindowStyle IconOverride, \
      Icon $[FVWM_USERDIR]/icon.tmp.$[w.id].png || \
      echo Nop"
  + I Iconify

DestroyFunc DeThumbnail
AddToFunc DeThumbnail
  + I Exec rm -f $[FVWM_USERDIR]/icon.tmp.$[w.id].png
  + I DestroyWindowStyle

*FvwmEvent: deiconify DeThumbnail
#AddToFunc StartFunction I Module FvwmEvent

AddToFunc StartFunction I Test (Restart) All (Iconic) \
  Test (f $[FVWM_USERDIR]/icon.tmp.$[w.id].png) WindowStyle \
  IconOverride, Icon $[FVWM_USERDIR]/icon.tmp.$[w.id].png

DestroyFunc ExitFunction
  AddToFunc ExitFunction I Test (!ToRestart) \
  Exec rm -f $[FVWM_USERDIR]/icon.tmp.*

#####################################
# Key bindings
#####################################

# Ignore NumLock key
IgnoreModifiers L25

# Super-Return gives you a new terminal, Super-Shift-Return gives you
# a new emacs instance running a terminal emulator
Key Return A 4 Rxvt
Key Return A 4S EmacsClient

# Super-d runs dmenu
Key d A 4 Exec exec dmenu_run

#DestroyFunc DisplayInfo
#AddToFunc DisplayInfo
#  + I Module FvwmButtons
#  + I KillModule FvwmButtons
#
#DestroyFunc ShowOrHideDisplayInfo
#  + I ThisWindow ("quick_terminal") hide_quick_terminal
#  + I ThisWindow (!"quick_terminal") raise_or_fire_quick_terminal
#  + I NoWindow raise_or_fire_quick_terminal

# Super held down displays window list
#Key Super_L A A DisplayInfo

# S-Super-c closes window
#Key c A 4S Close
Key c A 4S CloseWindow

# S-Super-r and S-Super-e to restart and quit fvwm
Key r A 4S Restart
Key e A 4S Quit

# Go to page with Super-{0,1,2,3,4,5,6,7,8,9}
Key 1 A 4 GotoPage 0 0
Key 2 A 4 GotoPage 1 0
Key 3 A 4 GotoPage 2 0
Key 4 A 4 GotoPage 0 1
Key 5 A 4 GotoPage 1 1
Key 6 A 4 GotoPage 2 1
Key 7 A 4 GotoPage 0 2
Key 8 A 4 GotoPage 1 2
Key 9 A 4 GotoPage 2 2

# Move window to page with S-Super-{0,1,2,3,4,5,6,7,8,9}
Key 1 FSTW 4S MoveToPage 0 0
Key 2 FSTW 4S MoveToPage 1 0
Key 3 FSTW 4S MoveToPage 2 0
Key 4 FSTW 4S MoveToPage 0 1
Key 5 FSTW 4S MoveToPage 1 1
Key 6 FSTW 4S MoveToPage 2 1
Key 7 FSTW 4S MoveToPage 0 2
Key 8 FSTW 4S MoveToPage 1 2
Key 9 FSTW 4S MoveToPage 2 2

# Go to page with C-M-{Left,Up,Down,Right} arrow keys
Key Down  A CM GotoPage  0p +1p
Key Up    A CM GotoPage  0p -1p
Key Right A CM GotoPage +1p  0p
Key Left  A CM GotoPage -1p  0p

# Move focused window to another page with C-M-S-{Left,Right,Down,Right} arrow keys
Key Down  A CMS MoveToPage  0p +1p
Key Up    A CMS MoveToPage  0p -1p
Key Right A CMS MoveToPage +1p  0p
Key Left  A CMS MoveToPage -1p  0p

# M-Tab opens window switcher
Key Tab A 4  FuncSwitchWindow

# Press arrow + meta + control anywhere, move window focus in that direction
Key Left	A	4	Direction West	(CurrentPage) SelectWindow
Key Right	A	4	Direction East	(CurrentPage) SelectWindow
Key Up		A	4	Direction North	(CurrentPage) SelectWindow
Key Down	A	4	Direction South	(CurrentPage) SelectWindow

# Lock screen with C-Super-l
Key l A C4 Exec exec i3lock -c 000000

# Maximize window with C-Super-Space
Key space W 4C Maximize grow grow

# Vertically maximize/grow window with C-Super-Up and C-Super-Down
Key Up A 4C Maximize 0 grow
Key Down A 4C Maximize 0 grow

# Horizontally maximize/grow window with C-Super-Left and
# C-Super-Right
Key Left A 4C Maximize grow 0
Key Right A 4C Maximize grow 0

# Change keyboard layouts between Norwegian QWERTY and Dvorak
AddToFunc KeymapToNorwegianQwerty
  + I Exec exec setxkbmap no
  + I Exec exec xmodmap ~/.Xmodmap

AddToFunc KeymapToDvorak
  + I Exec exec setxkbmap dvorak
  + I Exec exec xmodmap ~/.Xmodmap

Key Page_Up A 4S KeymapToNorwegianQwerty
Key Page_Down A 4S KeymapToDvorak

# Border styling
Style * NoTitle, BorderWidth 3
BorderStyle Active Solid SteelBlue4 -- NoInset HiddenHandles
BorderStyle Inactive Solid #11236b -- NoInset HiddenHandles

# Styles for various Fvwm modules:
Style Fvwm*       NoTitle,  Sticky, WindowListSkip
Style Fvwm*       BorderWidth 2, CirculateSkipIcon, CirculateSkip
Style FvwmPager   StaysOnTop
Style FvwmBanner  StaysOnTop
Style FvwmButtons Icon toolbox.xpm, ClickToFocus

# Styles for your common terminal emulator programs.
# xterms and rxvts in a separate icon box:
Style XTerm       Icon xterm.xpm, SloppyFocus, IconBox -70 1 -1 -140
Style rxvt        Icon term.xpm, SloppyFocus, IconBox -70 1 -1 -140
Style rxvt        MWMBorder, MWMButtons

# some simple default key bindings:
Key Next         A       SCM     Next [*] Focus
Key Prior        A       SCM     Prev [*] Focus

# Iconify window with C-S-z
Key Z FSTW SC Thumbnail

# Root window
Mouse	1	R	A	Menu MenuFvwmRoot Nop
Mouse	2	R	A	Menu MenuFvwmWindowOps Nop
Mouse	3	R	A	WindowList
Mouse	8	R	A	WindowList
Mouse	10	R	A	Menu MenuFvwmWindowOps Nop

# Title bar buttons
Mouse 0	1       A       Menu MenuFvwmWindowOps2 Close
Mouse 0 2       A       FuncFvwmMaximize
Mouse 0 4       A       Thumbnail

# Mouse-grab with Super for various window operations, click anywhere
# on a window
Mouse 1 FSTW M WindowLeftClick
Mouse 2 FSTW M Thumbnail
Mouse 3 FSTW M RaiseAndResize

# Move window with Super-{button 1} and resize with Super-{button 3},
# just like i3
Mouse 1 FSTW 4 FuncFvwmMoveOrRaise
Mouse 2 FSTW 4 FuncFvwmResizeOrRaise
Mouse 3 FSTW 4 FuncFvwmResizeOrRaise

# Shades and unshades active window
Mouse 4 T A FvwmWindowShade True
Mouse 5 T A FvwmWindowShade False

# Resize the thumbnail
Mouse 1 I N DeThumbnail

#   for other parts of the window/borders/icons:
Mouse 1		F	A	FuncFvwmResizeOrRaise
Mouse 1		TS	A	FuncFvwmMoveOrRaise
Mouse 1		I	A	FuncFvwmMoveOrIconify
Mouse 2		I	A	Thumbnail
Mouse 2		FST	A	Menu MenuFvwmWindowOps2 Nop
Mouse 3		TSIF	A	RaiseLower
Mouse 8		WTSIF	A	WindowList
Mouse 10	WTSIF	A	Menu MenuFvwmWindowOps Nop

######################## Menus ###################
# Make sure that the Debian menus, and the icons they reference, are
# available
ImagePath /usr/share/icons:/usr/share/pixmaps:/usr/share/icons/wm-icons:+
ImagePath +:/usr/X11R6/include/X11/pixmaps/:/usr/X11R6/include/X11/bitmaps/
ImagePath +:/usr/include/X11/bitmaps/
Read /etc/X11/fvwm/menudefs.hook Quiet
Read menudefs.hook Quiet

DestroyMenu MenuFvwmRoot
AddToMenu MenuFvwmRoot  "$[gt.Root Menu]"             Title
+                       "&1. Terminal"              Exec exec rxvt
+                       "&2. Firefox"               Exec exec firefox-trunk -new-window
+                       ""              Nop
+                       "&R. $[gt.Remote Logins]"     Popup MenuFvwmLogins
+                       ""              Nop
+                       "&U. $[gt.Utilities]"         Popup MenuFvwmUtilities
+                       ""              Nop
+                       "&F. $[gt.Refresh Screen]"   Refresh
+                       "&C. $[gt.Recapture Screen]" Recapture
+                       ""              Nop
+                       "&X. $[gt.fvwm]" Popup MenuFvwm

DestroyMenu MenuFvwmUtilities
AddToMenu MenuFvwmUtilities     "$[gt.Utilities]" Title
+                       "&T. Top"       Exec exec xterm -T Top -n Top -e top
+                       "&C. Calculator" Exec exec xcalc
+                       "&M. Xman"      Exec exec xman
+                       "&G. Xmag"      Exec exec xmag
+                       "&R. Editres"   Exec exec editres
+                       ""              Nop
+                       "&E. XEmacs"    Exec exec xemacs
+                       "&A. Xmh Mail"  FuncFvwmMailXmh xmh "-font fixed"
+                       ""              Nop
+                       "&L. XLock"     Exec exec xlock -mode random
+                       ""              Nop
+                       "&D. $[gt.Reset X defaults]" Exec xrdb -load $HOME/.Xdefaults

DestroyMenu MenuFvwmConfig
AddToMenu MenuFvwmConfig "$[gt.Fvwm Config Ops]" Title
+ "&S. $[gt.Sloppy Focus]"        FuncFvwmFocusPolicyChange SloppyFocus
+ "&C. $[gt.Click To Focus]"      FuncFvwmFocusPolicyChange ClickToFocus
+ "&F. $[gt.Focus Follows Mouse]" FuncFvwmFocusPolicyChange FocusFollowsMouse
+ "" Nop
+ "&1. $[gt.Colormap Follows Mouse]" ColormapFocus FollowsMouse
+ "&2. $[gt.Colormap Follows Focus]" ColormapFocus FollowsFocus
+ "" Nop
+ "&3. $[gt.Full Paging ON]"           EdgeScroll 100 100
+ "&4. $[gt.All Paging OFF]"           EdgeScroll 0 0
+ "&5. $[gt.Horizontal Paging Only]"   EdgeScroll 100 0
+ "&6. $[gt.Vertical Paging Only]"     EdgeScroll 0 100
+ "&7. $[gt.Partial Paging]"           EdgeScroll 50 50
+ "&8. $[gt.Full Paging && Edge Wrap]" EdgeScroll 100000 100000

# The window Ops menus exhibit a different HotKey style.
# There are 2 versions of the WindowOps Menu, meant to be bound to different
# things.  Here is the "common" part:
DestroyFunc FuncFvwmWindowCommon
AddToFunc FuncFvwmWindowCommon
+ I AddToMenu $0 "$[gt.&Move]"                Move
+ I AddToMenu $0 "$[gt.&Resize]"              Resize
+ I AddToMenu $0 "$[gt.R&aise]"               Raise
+ I AddToMenu $0 "$[gt.&Lower]"               Lower
+ I AddToMenu $0 "$[gt.(De)&Iconify]"         Thumbnail
+ I AddToMenu $0 "$[gt.(Un)&Stick]"           Stick
+ I AddToMenu $0 "$[gt.(Un)Ma&ximize]"        Maximize
+ I AddToMenu $0 "$[gt.(Un)&Grow vertically]" Maximize 0 grow
+ I AddToMenu $0 ""                 Nop
+ I AddToMenu $0 "$[gt.&Delete]"              Delete
+ I AddToMenu $0 "$[gt.&Close]"               Close
+ I AddToMenu $0 "$[gt.Destroy]"              Destroy
+ I AddToMenu $0 ""                 Nop

# First windowops menu, bound to:
# mouse 2 on root
# Root menu
DestroyMenu MenuFvwmWindowOps
AddToMenu MenuFvwmWindowOps     "$[gt.Window Ops]"    Title
FuncFvwmWindowCommon MenuFvwmWindowOps
+ "$[gt.Re&fresh Window]" RefreshWindow

# Second windowops menu, bound to:
# any mouse on titlebar button 1
# mouse 2 on frame, side or titlebar
DestroyMenu MenuFvwmWindowOps2
AddToMenu MenuFvwmWindowOps2
FuncFvwmWindowCommon MenuFvwmWindowOps2
+ Scroll&Bar       Module FvwmScroll 2 2
+ "&$[gt.Print]"           FuncFvwmPrint
+ "$[gt.Print Re&verse]" FuncFvwmPrintReverse

# 3 different ways to log on, take your pick:
DestroyFunc FuncFvwmRloginXterm
AddToFunc FuncFvwmRloginXterm \
  I Exec xterm -name $0 -title "$USER @ $0" -e rlogin $0
DestroyFunc FuncFvwmRloginRxvt
AddToFunc FuncFvwmRloginRxvt \
  I Exec rxvt -name $0 -n $0 -title $USER@$0 -e rlogin $0
DestroyFunc FuncFvwmRloginSshRxvt
AddToFunc FuncFvwmRloginSshRxvt \
  I Exec Exec ssh $0 rxvt -display $HOSTDISPLAY

# be sure to fill these in with your correct machine names:
DestroyMenu MenuFvwmLogins
AddToMenu MenuFvwmLogins
+ &dopey  FuncFvwmRloginXterm dopey
+ &snoopy FuncFvwmRloginXterm snoopy
+ s&ignal Exec rxterm signal

DestroyMenu MenuFvwmModules
AddToMenu MenuFvwmModules "$[gt.Fvwm Modules]"        Title
+ "&1. $[gt.Control Animation]" Popup  MenuFvwmAnimate
+ "&B. Button-Bar"        Module FvwmButtons
+ "&O. IconBox"           FuncFvwmConfigureIconBox
+ "&F. Forms"             Popup  MenuFvwmForms
+ "&I. Identify"          Module FvwmIdent
+ "&M. IconMan"           Module FvwmIconMan
+ "&N. Banner"            Module FvwmBanner
+ "&C. Console"           Module FvwmConsole
+ "&P. Pager"             Module FvwmPager 0 0
+ "&2. Pager (2 $[gt.desks])"   Module FvwmPager 0 1
+ "&R. Backer"            Module FvwmBacker
+ "&S. ScrollBar"         Module FvwmScroll 50 50
+ "&T. FvwmTaskBar"       Module FvwmTaskBar
+ "&U. AutoRaise"         Module FvwmAuto 200 Raise Nop
+ "&W. WinList"           Module FvwmWinList
+ "&X. $[gt.Stop Module Menu]"  Popup  MenuFvwmStopModule

DestroyMenu MenuFvwmStopModule
AddToMenu MenuFvwmStopModule "$[gt.Stop Fvwm Modules]" Title
+ "&B. $[gt.Stop] Button-Bar"  KillModule FvwmButtons
+ "&O. $[gt.Stop] IconBox"     KillModule FvwmIconBox
+ "&M. $[gt.Stop] IconMan"     KillModule FvwmIconMan
+ "&P. $[gt.Stop] Pager"       KillModule FvwmPager
+ "&R. $[gt.Stop] Backer"      KillModule FvwmBacker
+ "&S. $[gt.Stop] ScrollBar"   KillModule FvwmScroll
+ "&T. $[gt.Stop] FvwmTaskBar" KillModule FvwmTaskBar
+ "&U. $[gt.Stop] AutoRaise"   KillModule FvwmAuto
+ "&W. $[gt.Stop] WinList"     KillModule FvwmWinList

DestroyMenu MenuFvwmForms
AddToMenu MenuFvwmForms
+ "&C. Capture"       Module FvwmForm FvwmForm-Capture
+ "&D. Form Defaults" Module FvwmForm FvwmForm-Form
+ "&R. Rlogin"        Module FvwmForm FvwmForm-Rlogin
+ "&P. RootCursor"    Module FvwmForm FvwmForm-RootCursor
+ "&S. Setup"         Module FvwmForm FvwmForm-Setup
+ "&T. Talk Form"     Module FvwmForm FvwmForm-Talk
+ "&Q. QuitVerify"    Module FvwmForm FvwmForm-QuitVerify

# Configure and start using an iconbox on the fly
DestroyFunc FuncFvwmConfigureIconBox
AddToFunc FuncFvwmConfigureIconBox
+ I Module FvwmIconBox
+ I Style     *  NoIcon

DestroyMenu MenuFvwm
AddToMenu MenuFvwm
+ "&Q. $[gt.Quit]" Quit
+ "&R. $[gt.Restart]"          Restart
+ ""                     Nop
+                       "&M. $[gt.Fvwm Modules]"      Popup MenuFvwmModules
+                       "&W. $[gt.Fvwm Window Ops]"   Popup MenuFvwmWindowOps
+                       "&S. $[gt.Fvwm Config Ops]"   Popup MenuFvwmConfig
+ ""                     Nop
+ "&N. $[gt.No, Don't Quit]"   Nop

######################## Sample Functions ##########################

DestroyFunc FuncFvwmMailXmh
AddToFunc FuncFvwmMailXmh
+ I Next [$0] Iconify false
+ I Next [$0] Focus
+ I None [$0] Exec $0 $1

DestroyFunc FuncFvwmMoveOrRaise
AddToFunc FuncFvwmMoveOrRaise
+ I Raise
+ M Move
+ D Lower

DestroyFunc FuncFvwmMaximize
AddToFunc FuncFvwmMaximize
+ M Maximize   0 100
+ H Maximize   0 100
+ C Maximize   0  80
+ D Maximize 100 100

DestroyFunc FuncFvwmMoveOrIconify
AddToFunc FuncFvwmMoveOrIconify
+ I Raise
+ M Move
+ D Thumbnail

DestroyFunc FuncFvwmResizeOrRaise
AddToFunc FuncFvwmResizeOrRaise
+ I Raise
+ M Resize
+ D Lower

DestroyFunc FuncFvwmPrint
AddToFunc FuncFvwmPrint
+ I Raise
+ I Exec xdpr -id $w

DestroyFunc FuncFvwmPrintReverse
AddToFunc FuncFvwmPrintReverse
+ I Raise
+ I Exec xdpr 1/2 -h -rv -id $w

DestroyFunc FuncFvwmFocusPolicyChange
AddToFunc FuncFvwmFocusPolicyChange
+ I Style * $0
+ I Recapture

# Read config files for modules:
#read ConfigFvwmBacker
#read ConfigFvwmButtons  # <--
#read ConfigFvwmIconBox
#read ConfigFvwmIconMan
#read ConfigFvwmIdent
#read ConfigFvwmPager
#read ConfigFvwmScroll
#read ConfigFvwmTaskBar
#read ConfigFvwmWinList
